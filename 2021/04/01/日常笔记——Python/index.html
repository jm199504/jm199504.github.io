<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>日常笔记——Python | Jimmy&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="概述：日常笔记——Python">
<meta property="og:type" content="article">
<meta property="og:title" content="日常笔记——Python">
<meta property="og:url" content="http://example.com/2021/04/01/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/index.html">
<meta property="og:site_name" content="Jimmy&#39;s blog">
<meta property="og:description" content="概述：日常笔记——Python">
<meta property="og:locale">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/fhujzoQe7TrGa4hyhWRYBIYJImp81lDuaYQNIb7icoqbV5qzqRrAIMGibNeWicsSBib8Lp5Sd7JCEiap1QMcKz8f07A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="article:published_time" content="2021-04-01T02:53:58.727Z">
<meta property="article:modified_time" content="2021-04-06T11:33:15.588Z">
<meta property="article:author" content="Jimmy Guo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mmbiz.qpic.cn/mmbiz_png/fhujzoQe7TrGa4hyhWRYBIYJImp81lDuaYQNIb7icoqbV5qzqRrAIMGibNeWicsSBib8Lp5Sd7JCEiap1QMcKz8f07A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
  
    <link rel="alternate" href="/atom.xml" title="Jimmy's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jimmy&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-日常笔记——Python" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/01/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/" class="article-date">
  <time class="dt-published" datetime="2021-04-01T02:53:58.727Z" itemprop="datePublished">2021-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      日常笔记——Python
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>概述：日常笔记——Python</p>
<span id="more"></span>

<p>[TOC]</p>
<h2 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.__version__</span><br></pre></td></tr></table></figure>

<h3 id="创建随机值及数组"><a href="#创建随机值及数组" class="headerlink" title="创建随机值及数组"></a>创建随机值及数组</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机数：0-10</span></span><br><span class="line">a = np.random.randint(<span class="number">10</span>, size=(<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一位数组</span></span><br><span class="line"><span class="built_in">print</span>(np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维数组</span></span><br><span class="line"><span class="built_in">print</span>(np.array([(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建全零数组</span></span><br><span class="line"><span class="built_in">print</span>(np.zeros((<span class="number">3</span>,<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建全一数组</span></span><br><span class="line"><span class="built_in">print</span>(np.ones((<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一维等差数组(0 1 2 3 4)</span></span><br><span class="line"><span class="built_in">print</span>(np.arange(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维等差数列</span></span><br><span class="line"><span class="built_in">print</span>(np.arange(<span class="number">6</span>).reshape(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建单位矩阵（二维数组）</span></span><br><span class="line"><span class="built_in">print</span>(np.eye(<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建等间隔的一维数组</span></span><br><span class="line"><span class="built_in">print</span>(np.linspace(<span class="number">1</span>, <span class="number">10</span>, num=<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维随机数组</span></span><br><span class="line"><span class="built_in">print</span>(np.random.rand(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维随机整数数组（数值小于 5）</span></span><br><span class="line"><span class="built_in">print</span>(np.random.randint(<span class="number">5</span>, size=(<span class="number">2</span>,<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 依据自定义函数创建数组</span></span><br><span class="line"><span class="built_in">print</span>(np.fromfunction(<span class="keyword">lambda</span> i, j: i + j, (<span class="number">3</span>, <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成二维示例数组（可以看作矩阵）</span></span><br><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]])</span><br><span class="line">B = np.array([[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成一维示例数组[0:1]</span></span><br><span class="line"><span class="built_in">print</span>(np.random.random((<span class="number">3</span>, <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#np.random.rand()  生成一个[0,1)之间的随机浮点数或N维浮点数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成生成[0,1)之间随机浮点数</span></span><br><span class="line"><span class="built_in">print</span>(np.random.rand())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成一个形状为5的一维数组</span></span><br><span class="line"><span class="built_in">print</span>(np.random.rand(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成2x3的二维数组</span></span><br><span class="line"><span class="built_in">print</span>(np.random.rand(<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<h3 id="运算及转换"><a href="#运算及转换" class="headerlink" title="运算及转换"></a>运算及转换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 矩阵乘法运算</span></span><br><span class="line"><span class="built_in">print</span>(np.dot(A, B))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 np.mat 将二维数组准确定义为矩阵，就可以直接使用 * 完成矩阵乘法计算 = np.dot(A,B)</span></span><br><span class="line"><span class="built_in">print</span>(np.mat(A) * np.mat(B))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩阵的转置</span></span><br><span class="line"><span class="built_in">print</span>(A.T)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩阵求逆</span></span><br><span class="line"><span class="built_in">print</span>(np.linalg.inv(A))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 三角函数</span></span><br><span class="line"><span class="built_in">print</span>(np.sin(np.array([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span>])))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以自然对数函数为底数的指数函数</span></span><br><span class="line"><span class="built_in">print</span>(np.exp(a))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组的方根的运算（开平方）</span></span><br><span class="line"><span class="built_in">print</span>(np.sqrt(a))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组的方根的运算（立方）</span></span><br><span class="line"><span class="built_in">print</span>(np.power(a, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改数组形状（不改变原始数组）</span></span><br><span class="line">a.reshape(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改数组形状（会改变原始数组）</span></span><br><span class="line">a.resize(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展平数组</span></span><br><span class="line">a.ravel()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 垂直拼合数组</span></span><br><span class="line"><span class="built_in">print</span>(np.vstack((a, b)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 水平拼合数组</span></span><br><span class="line"><span class="built_in">print</span>(np.hstack((a, b)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 沿纵轴分割数组</span></span><br><span class="line"><span class="built_in">print</span>(np.hsplit(a, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 沿横轴分割数组</span></span><br><span class="line"><span class="built_in">print</span>(np.vsplit(a, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回每列最大值</span></span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">max</span>(a, axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回每行最小值</span></span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">min</span>(a, axis=<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回每列最大值索引</span></span><br><span class="line"><span class="built_in">print</span>(np.argmax(a, axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计数组各列的中位数</span></span><br><span class="line"><span class="built_in">print</span>(np.median(a, axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组各行的算术平均值</span></span><br><span class="line"><span class="built_in">print</span>(np.mean(a, axis=<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组各列的加权平均值</span></span><br><span class="line"><span class="built_in">print</span>(np.average(a, axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计数组各行的方差</span></span><br><span class="line"><span class="built_in">print</span>(np.var(a, axis=<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计数组各列的标准偏差</span></span><br><span class="line"><span class="built_in">print</span>(np.std(a, axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.rand()  生成一个浮点数或N维浮点数组，取数范围：正态分布的随机样本数</span></span><br><span class="line"><span class="built_in">print</span>(np.random.randn())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.random.randn(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.standard_normal(size=None)：生成一个浮点数或N维浮点数组，取数范围：标准正态分布随机样本</span></span><br><span class="line"><span class="built_in">print</span>(np.random.standard_normal(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(np.random.standard_normal((<span class="number">2</span>,<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.randint(low, high=None, size=None, dtype=&#x27;l&#x27;)：</span></span><br><span class="line"><span class="comment"># 生成一个整数或N维整数数组，取数范围：若high不为None时，取[low,high)之间随机整数，否则取值[0,low)之间随机整数。</span></span><br><span class="line"><span class="built_in">print</span>(np.random.randint(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(np.random.randint(<span class="number">2</span>,size=<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(np.random.randint(<span class="number">2</span>,<span class="number">6</span>,size=<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.choice(a, size=None, replace=True, p=None)：</span></span><br><span class="line"><span class="comment"># 从序列中获取元素，若a为整数，元素取值为np.range(a)中随机数；若a为数组，取值为a数组元素中随机元素</span></span><br><span class="line"><span class="built_in">print</span>(np.random.choice(<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(np.random.choice(np.array([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;f&#x27;</span>]),(<span class="number">2</span>,<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.shuffle(x)：对X进行重排序，如果X为多维数组，整行重排</span></span><br><span class="line">list1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">np.random.shuffle(list1)</span><br><span class="line"><span class="built_in">print</span>(list1)</span><br><span class="line"></span><br><span class="line">arr = np.arange(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"></span><br><span class="line">np.random.shuffle(arr)</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.random.permutation(x)：与numpy.random.shuffle(x)函数功能相同，两者区别：peumutation(x)不会修改X的顺序</span></span><br><span class="line"><span class="built_in">print</span>(np.random.permutation(<span class="number">5</span>))<span class="comment">#生成一个range(5)随机顺序的数组</span></span><br><span class="line"></span><br><span class="line">list1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">np.random.permutation(list1)</span><br><span class="line"><span class="built_in">print</span>(list1)</span><br></pre></td></tr></table></figure>

<h2 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h2><h3 id="读取-写入文件"><a href="#读取-写入文件" class="headerlink" title="读取/写入文件"></a>读取/写入文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取CSV文件</span></span><br><span class="line">pd.DataFrame.from_csv(<span class="string">&quot;csv_file&quot;</span>)</span><br><span class="line"><span class="comment"># 读取CSV文件</span></span><br><span class="line">pd.read_csv(<span class="string">&quot;csv_file&quot;</span>)</span><br><span class="line"><span class="comment"># 读取Excel</span></span><br><span class="line">pd.read_excel(<span class="string">&quot;excel_file&quot;</span>)</span><br><span class="line"><span class="comment"># 将DataFrame写入CSV</span></span><br><span class="line"><span class="comment"># 其中以&quot;,&quot;为分隔符，不带索引或者使用index=None均可实现</span></span><br><span class="line">df.to_csv(<span class="string">&quot;data.csv&quot;</span>, sep=<span class="string">&quot;,&quot;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="DF相关信息"><a href="#DF相关信息" class="headerlink" title="DF相关信息"></a>DF相关信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DataFrame基本统计信息</span></span><br><span class="line"><span class="comment"># 返回dataframe的每一列/属性的数量、均值、标准差、最小值、四分位数、最大值</span></span><br><span class="line">df.describe()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看DataFrame的基本信息量</span></span><br><span class="line">df.info()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 索引和属性</span></span><br><span class="line">df.index  <span class="comment"># 索引</span></span><br><span class="line">df.columns  <span class="comment"># 属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新设置index</span></span><br><span class="line">df = df.set_index(<span class="string">&#x27;trade_date&#x27;</span>) </span><br></pre></td></tr></table></figure>

<h3 id="处理缺失值"><a href="#处理缺失值" class="headerlink" title="处理缺失值"></a>处理缺失值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除：axis=0代表列，axis=1代表行，how=&#x27;all&#x27;表示均为NaN删除，how=&#x27;any&#x27;表示存在某一个NaN则删除</span></span><br><span class="line">df.dropna(axis=<span class="number">0</span>,how=<span class="string">&#x27;all&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用全局常量填充缺失值</span></span><br><span class="line">df=df.fillna(value=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 均值填充</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].fillna(df[<span class="string">&#x27;a&#x27;</span>].means())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 中位数填充</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].fillna(df[<span class="string">&#x27;a&#x27;</span>].median())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 众数填充</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].fillna(stats.mode(df[<span class="string">&#x27;a&#x27;</span>])[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用前一个数据进行填充</span></span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> stats</span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].fillna(method=<span class="string">&#x27;pad&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用后一个数据进行填充</span></span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> stats</span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].fillna(method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查缺失值NaN</span></span><br><span class="line">pd.isnull(df.<span class="built_in">open</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用&quot; &quot;替换空值</span></span><br><span class="line">df = df.replace(<span class="string">&quot; &quot;</span>,np.NaN)</span><br></pre></td></tr></table></figure>

<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除列</span></span><br><span class="line">df.drop(<span class="string">&#x27;open&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line"><span class="keyword">del</span> data[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line"><span class="comment"># 删除行</span></span><br><span class="line">df.drop(df.index[[<span class="number">0</span>, <span class="number">2</span>]], inplace=<span class="literal">True</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将某列转为浮点类型</span></span><br><span class="line">pd.to_numeric(df[<span class="string">&quot;open&quot;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将DataFrame转为Numpy</span></span><br><span class="line">df.as_matrix()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据属性和索引定位具体值 df.loc[索引,列名]</span></span><br><span class="line"><span class="comment"># 读取索引为&#x27;2019-11-07&#x27;的列名&#x27;open&#x27;的值</span></span><br><span class="line">df.loc[<span class="string">&#x27;2019-11-07&#x27;</span>,<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 累加操作</span></span><br><span class="line">data = data.cumsum()</span><br></pre></td></tr></table></figure>

<h3 id="合并数据集"><a href="#合并数据集" class="headerlink" title="合并数据集"></a>合并数据集</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成数据集</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">0</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">1</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df3 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">2</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="comment"># 对多个DataFrame合并操作</span></span><br><span class="line">res = pd.concat([df1, df2, df3], axis=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 数据输出(axis=0表示纵向合并，axis=1表示横向合并)</span></span><br><span class="line"><span class="comment"># 在数据输出纵向合并时index会有重复，可以使用index_ignore参数修改：</span></span><br><span class="line">res = pd.concat([df1, df2, df3], axis=<span class="number">0</span>, ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 面对不同列名的多个DataFrame合并时，定义两个列名不同的DataFrame</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">0</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>], index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">1</span>, columns=[<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>], index=[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="comment"># concat合并时参数join默认为outer，还可选择inner</span></span><br><span class="line">res = pd.concat([df1, df2], axis=<span class="number">0</span>, join=<span class="string">&#x27;outer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 除了使用concat合并之外，还可以使用append对DataFrame进行纵向合并，注意append仅能纵向合并</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">0</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">1</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">res = df1.append(df2, ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实现大于2个DataFrame的append合并：</span></span><br><span class="line">df1 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">0</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">1</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">df3 = pd.DataFrame(np.ones((<span class="number">3</span>,<span class="number">4</span>))*<span class="number">1</span>, columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">res = df1.append([df2, df3], ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h3 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 汇总统计</span></span><br><span class="line"><span class="built_in">print</span>(df.describe())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 非NaN值统计</span></span><br><span class="line"><span class="built_in">print</span>(df.count())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 最大值和最小值</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">min</span>())</span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">max</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 最大值和最小值所对应的索引值，由于多维度，不指定具体的属性将会报错</span></span><br><span class="line"><span class="comment"># 另外idxmin/idmax仅返回index的下标</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;date&#x27;</span>][df[<span class="string">&#x27;open&#x27;</span>].idxmin()])</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;open&#x27;</span>].idxmax())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 数据集的分位数，默认为0.5 显示2/4分位数</span></span><br><span class="line"><span class="comment"># df.quantile(0.75)，显示3/4分位数</span></span><br><span class="line"><span class="built_in">print</span>(df.quantile())</span><br><span class="line"><span class="built_in">print</span>(df.quantile(<span class="number">0.75</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6 列值总和</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7 各列均值</span></span><br><span class="line"><span class="built_in">print</span>(df.mean())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8 各列中位数</span></span><br><span class="line"><span class="built_in">print</span>(df.mean())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9 各列根据平均值计算平均绝对离差，即平均绝对误差（Mean Absolute Deviation）</span></span><br><span class="line"><span class="built_in">print</span>(df.mad())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10 各列方差</span></span><br><span class="line"><span class="built_in">print</span>(df.var())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11 各列标准差</span></span><br><span class="line"><span class="built_in">print</span>(df.std())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 12 各列偏度，即三阶标准化矩</span></span><br><span class="line"><span class="built_in">print</span>(df.skew())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 13 各列峰度</span></span><br><span class="line"><span class="built_in">print</span>(df.kurt())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 14 各列累加和</span></span><br><span class="line"><span class="built_in">print</span>(df.cumsum())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 15 各列累加和最大值和最小值</span></span><br><span class="line"><span class="built_in">print</span>(df.cummin())</span><br><span class="line"><span class="built_in">print</span>(df.cumax())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 16 各列累积</span></span><br><span class="line"><span class="built_in">print</span>(df.cumprod())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 17 各列一阶方差</span></span><br><span class="line"><span class="built_in">print</span>(df.diff())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 18 各列百分数变化</span></span><br><span class="line"><span class="built_in">print</span>(df.pct_change())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 19 修改列名</span></span><br><span class="line">df.columns = [<span class="string">&quot;f1&quot;</span>,<span class="string">&quot;f2&quot;</span>,<span class="string">&quot;f3&quot;</span>,<span class="string">&quot;f4&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 20 随机生成df（默认4列[A,B,C,D]）</span></span><br><span class="line">pd.util.testing.makeDataFrame().head(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 21 将excel等表格转为df</span></span><br><span class="line">（<span class="number">1</span>）复制表格</span><br><span class="line">（<span class="number">2</span>）执行pd.read_clipboard</span><br><span class="line"></span><br><span class="line"><span class="comment"># 22 查看df的当前内存用量</span></span><br><span class="line">df.info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 23 限制读取行数</span></span><br><span class="line">reader = pd.read_csv(<span class="string">&quot;http://...&quot;</span>,chunksize=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 24 显示所有列</span></span><br><span class="line">pd.set_option(<span class="string">&quot;display.max_columns&quot;</span>, <span class="literal">None</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 25 改变浮点数显示位数(1位)</span></span><br><span class="line">pd.set_option(<span class="string">&quot;display.precision&quot;</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 26 修改样式</span></span><br><span class="line">df.style.bar(<span class="string">&quot;age&quot;</span>,vmin=<span class="number">0</span>)<span class="comment"># 年龄属性最小值为0画横向柱状</span></span><br><span class="line">df.style.hide_index()<span class="comment"># 隐藏索引</span></span><br><span class="line">df.style.highlight_max(<span class="string">&quot;label&quot;</span>)<span class="comment"># 高亮标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选取前n行数据</span></span><br><span class="line">df.head(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据排序</span></span><br><span class="line">df = df.sort_values(<span class="string">&quot;open&quot;</span>,ascending = <span class="literal">False</span>)</span><br><span class="line">//对具体某列进行排序，其中ascending=<span class="literal">False</span>表示降序，而<span class="literal">True</span>为升序，其默认ascending为升序</span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤数据</span></span><br><span class="line">df = df[df[<span class="string">&quot;open&quot;</span>]&gt;<span class="number">5555</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><p>使用matplotlib和numpy配合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单一数据可视化</span></span><br><span class="line"><span class="comment"># 生成1000个随机数并数据可视化</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">data = pd.Series(np.random.randn(<span class="number">1000</span>),index=np.arange(<span class="number">1000</span>))</span><br><span class="line">data.plot()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多维数据可视化</span></span><br><span class="line"><span class="comment"># 生成1000×4维度的随机数并数据可视化</span></span><br><span class="line">data = pd.DataFrame(np.random.randn(<span class="number">1000</span>,<span class="number">4</span>),index=np.arange(<span class="number">1000</span>),columns=<span class="built_in">list</span>(<span class="string">&quot;ABCD&quot;</span>))</span><br><span class="line">data.plot()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对多维数据进行散点图展示</span></span><br><span class="line">ax = data.plot.scatter(x=<span class="string">&#x27;A&#x27;</span>, y=<span class="string">&#x27;B&#x27;</span>, color=<span class="string">&#x27;DarkBlue&#x27;</span>, label=<span class="string">&quot;Class 1(A/B)&quot;</span>)</span><br><span class="line">bx = data.plot.scatter(x=<span class="string">&#x27;A&#x27;</span>, y=<span class="string">&#x27;C&#x27;</span>, color=<span class="string">&#x27;LightBlue&#x27;</span>, label=<span class="string">&quot;Class 2(A/C)&quot;</span>,ax=ax)</span><br><span class="line">data.plot.scatter(x=<span class="string">&#x27;A&#x27;</span>, y=<span class="string">&#x27;D&#x27;</span>, color=<span class="string">&#x27;LightGreen&#x27;</span>, label=<span class="string">&#x27;Class 3(A/D)&#x27;</span>, ax=bx)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>在Python中一切皆为对象，所有变量被赋值后均遵循对象引用机制，在运行时需要再内存中开辟一个空间，计算完成后将结果输出至永久性存储器，当数据量过大时易出现OOM（out of memory），即内存爆炸。</p>
<p>当一个对象不再被调用时，当该对象的引用计数指针数为0，需要被回收，可以通过以下命令查看指定变量被引用的次数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">a = <span class="number">123</span></span><br><span class="line"><span class="built_in">print</span>(sys.getrefcount(a))</span><br><span class="line"><span class="comment"># result:2 一次来源于声明a变量；一次来源于getrefcount(a)</span></span><br></pre></td></tr></table></figure>

<p>手动释放内存：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gc</span><br><span class="line">gc.collect()</span><br><span class="line">show_memory_info(<span class="string">&#x27;collected&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>当两个局部变量循环引用时，即当a与b互相引用时，即使函数完成后其引用数也不为0，对于该情况时可以采取人工回收。</p>
<h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><h3 id="计数引用"><a href="#计数引用" class="headerlink" title="计数引用"></a>计数引用</h3><p>当一个对象不再调用的时候，也就是当这个对象的引用计数（指针数）为 0 的时候，说明这个对象永不可达，自然它也就成为了垃圾，需要被回收。可以简单的理解为没有任何变量再指向它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> psutil</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示当前 python 程序占用的内存大小</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_memory_info</span>(<span class="params">hint</span>):</span></span><br><span class="line">    pid = os.getpid()</span><br><span class="line">    p = psutil.Process(pid)</span><br><span class="line"></span><br><span class="line">    info = p.memory_full_info()</span><br><span class="line">    memory = info.uss / <span class="number">1024.</span>/ <span class="number">1024</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; memory used: &#123;&#125; MB&#x27;</span>.<span class="built_in">format</span>(hint, memory))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    show_memory_info(<span class="string">&#x27;initial&#x27;</span>)</span><br><span class="line">    a = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]</span><br><span class="line">    show_memory_info(<span class="string">&#x27;after a created&#x27;</span>)</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line">show_memory_info(<span class="string">&#x27;finished&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########## 输出 ##########</span></span><br><span class="line">initial memory used: <span class="number">47.19140625</span> MB</span><br><span class="line">after a created memory used: <span class="number">433.91015625</span> MB</span><br><span class="line">finished memory used: <span class="number">48.109375</span> MB</span><br></pre></td></tr></table></figure>

<p>可以看到调用函数 func()，在列表 a 被创建之后，内存占用迅速增加到了 433 MB：而在函数调用结束后，内存则返回正常。这是因为，函数内部声明的列表 a 是局部变量，在函数返回后，局部变量的引用会注销掉；此时，列表 a 所指代对象的引用数为 0，Python 便会执行垃圾回收，因此之前占用的大量内存就又回来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span></span></span><br><span class="line"><span class="function"> <span class="title">func</span>():</span></span><br><span class="line">    show_memory_info(<span class="string">&#x27;initial&#x27;</span>)</span><br><span class="line"><span class="keyword">global</span> a    </span><br><span class="line">a = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]</span><br><span class="line">    show_memory_info(<span class="string">&#x27;after a created&#x27;</span>)</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line">show_memory_info(<span class="string">&#x27;finished&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########## 输出 ##########</span></span><br><span class="line"></span><br><span class="line">initial memory used: <span class="number">48.88671875</span> MB</span><br><span class="line">after a created memory used: <span class="number">433.94921875</span> MB</span><br><span class="line">finished memory used: <span class="number">433.94921875</span> MB</span><br></pre></td></tr></table></figure>

<p>新的这段代码中，global a 表示将 a 声明为全局变量。那么，即使函数返回后，列表的引用依然存在，于是对象就不会被垃圾回收掉，依然占用大量内存。同样，如果我们把生成的列表返回，然后在主程序中接收，那么引用依然存在，垃圾回收就不会被触发，大量内存仍然被占用着：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span></span></span><br><span class="line"><span class="function"> <span class="title">func</span>():</span></span><br><span class="line">    show_memory_info(<span class="string">&#x27;initial&#x27;</span>)</span><br><span class="line">    a = [i <span class="keyword">for</span> i <span class="keyword">in</span> derange(<span class="number">10000000</span>)]</span><br><span class="line">    show_memory_info(<span class="string">&#x27;after a created&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">a = func()</span><br><span class="line">show_memory_info(<span class="string">&#x27;finished&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########## 输出 ##########</span></span><br><span class="line"></span><br><span class="line">initial memory used: <span class="number">47.96484375</span> MB</span><br><span class="line">after a created memory used: <span class="number">434.515625</span> MB</span><br><span class="line">finished memory used: <span class="number">434.515625</span> MB</span><br></pre></td></tr></table></figure>

<h3 id="循环回收"><a href="#循环回收" class="headerlink" title="循环回收"></a>循环回收</h3><p>如果有两个对象，它们互相引用，并且不再被别的对象所引用，那么它们应该被垃圾回收吗？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span></span></span><br><span class="line"><span class="function"> <span class="title">func</span>():</span></span><br><span class="line">    show_memory_info(<span class="string">&#x27;initial&#x27;</span>)</span><br><span class="line">    a = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]</span><br><span class="line">    b = [i </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]</span><br><span class="line">    show_memory_info(<span class="string">&#x27;after a, b created&#x27;</span>)</span><br><span class="line">    a.append(b)</span><br><span class="line">    b.append(a)</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line">show_memory_info(<span class="string">&#x27;finished&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########## 输出 ##########</span></span><br><span class="line"></span><br><span class="line">initial memory used: <span class="number">47.984375</span> MB</span><br><span class="line">after a, b created memory used: <span class="number">822.73828125</span> MB</span><br><span class="line">finished memory used: <span class="number">821.73046875</span> MB</span><br></pre></td></tr></table></figure>

<p>从结果显而易见，它们并没有被回收，但是从程序上来看，当这个函数结束的时候，作为局部变量的a，b就已经从程序意义上不存在了。但是因为它们的互相引用，导致了它们的引用数都不为0。</p>
<p>这时要如何规避呢1. 从代码逻辑上进行整改，避免这种循环引用2. 通过人工回收</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gc</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line">    show_memory_info(<span class="string">&#x27;initial&#x27;</span>)</span><br><span class="line">    a = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]    </span><br><span class="line">    b = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>)]</span><br><span class="line">    show_memory_info(<span class="string">&#x27;after a, b created&#x27;</span>)</span><br><span class="line">    a.append(b)</span><br><span class="line">    b.append(a)</span><br><span class="line"></span><br><span class="line">func()</span><br><span class="line">gc.collect()</span><br><span class="line">show_memory_info(<span class="string">&#x27;finished&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">########## 输出 ##########</span></span><br><span class="line"></span><br><span class="line">initial memory used: <span class="number">49.51171875</span> MB</span><br><span class="line">after a, b created memory used: <span class="number">824.1328125</span> MB</span><br><span class="line">finished memory used: <span class="number">49.98046875</span> MB</span><br></pre></td></tr></table></figure>

<p>python面对循环引用有自动垃圾回收算法：</p>
<p>（1）自动垃圾回收算法——标记清除（mark-sweep）</p>
<p>垃圾回收机制会把所有变量都打上标记，将没有标记的对象进行回收，mark-sweep使用双向链表维护一个数据结构，通常仅包含容器类对象：list、dict、tuplle、instance。</p>
<p>（2）自动垃圾回收算法——分代回收（generational）</p>
<p>分代回收是一种以空间换时间的操作，python根据对象的存活时间划分为不同的集合，其中每一个集合称为一个代，将内存分为3个代，分别为:</p>
<ul>
<li><p>年轻代（第0代）</p>
</li>
<li><p>中年代（第1代）</p>
</li>
<li><p>老年代（第2代）</p>
</li>
</ul>
<p>对应3个链表，对象的存活时间越大，垃圾收集频率越低。</p>
<p>新创建的对象均被分配在年轻代，当年轻代链表总数达到上限时，python垃圾回收机制会被触发，将待回收对象回收，将暂不回收被移到中年代，老年代的对象是存活时间最久的对象。</p>
<h2 id="random"><a href="#random" class="headerlink" title="random"></a>random</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 随机生成0-1的随机数</span></span><br><span class="line">random.random()<span class="comment">#0.444365931841868</span></span><br><span class="line"><span class="comment"># 随机生成2-5之间的整数</span></span><br><span class="line">random.randint(<span class="number">2</span>,<span class="number">5</span>)<span class="comment">#3</span></span><br><span class="line"><span class="comment"># 随机生成2-5之间的有理数</span></span><br><span class="line">random.uniform(<span class="number">2</span>,<span class="number">5</span>)<span class="comment">#2.391457672495461</span></span><br><span class="line"><span class="comment"># 从[10,12,14,...,100]随机生成1个数</span></span><br><span class="line">random.randrange(<span class="number">10</span>,<span class="number">100</span>,<span class="number">2</span>)<span class="comment">#72</span></span><br><span class="line"><span class="comment"># 从[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;]随机生成1个项</span></span><br><span class="line">random.choice([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="number">1</span>])<span class="comment">#&#x27;c&#x27;</span></span><br><span class="line"><span class="comment"># 打乱列表</span></span><br><span class="line">p = [<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;is&#x27;</span>,<span class="string">&#x27;powerful&#x27;</span>]</span><br><span class="line">random.shuffle(p)</span><br><span class="line"><span class="built_in">print</span>(p)<span class="comment"># [&#x27;powerful&#x27;, &#x27;is&#x27;, &#x27;python&#x27;]</span></span><br><span class="line"><span class="comment"># 打乱顺序且随机选取3个数</span></span><br><span class="line">random.sample([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="number">3</span>)<span class="comment">#[1, 3, 2]</span></span><br><span class="line"><span class="comment"># 随机选取3个数</span></span><br><span class="line">random.sample([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="number">3</span>)<span class="comment">#[1, 3, 2]</span></span><br><span class="line"><span class="comment"># 指定前5次随机生成数相同</span></span><br><span class="line">random.seed(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h2 id="🔧工具-——-pycharm-解决冲突"><a href="#🔧工具-——-pycharm-解决冲突" class="headerlink" title="🔧工具 —— pycharm 解决冲突"></a>🔧工具 —— pycharm 解决冲突</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Right Click</span><br><span class="line">	&gt; Git</span><br><span class="line">		&gt; Resolve Conflicts ...</span><br><span class="line">			&gt; Double Click File</span><br><span class="line">				&gt; 选择代码行</span><br></pre></td></tr></table></figure>

<h2 id="当前运行目录"><a href="#当前运行目录" class="headerlink" title="当前运行目录"></a>当前运行目录</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 该文件所在位置：D:\第1层\第2层\第3层\第4层\第5层\test11.py</span></span><br><span class="line"></span><br><span class="line">path0 = os.path.abspath(__file__)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path0: <span class="subst">&#123;path0&#125;</span>&#x27;</span>) <span class="comment"># 获取当前运行脚本的绝对路径</span></span><br><span class="line"></span><br><span class="line">path1 = os.path.dirname(__file__)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path1: <span class="subst">&#123;path1&#125;</span>&#x27;</span>)  <span class="comment"># 获取当前运行脚本的目录绝对路径</span></span><br><span class="line"></span><br><span class="line">path2 = os.path.dirname(os.path.dirname(__file__))  <span class="comment">#</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path2: <span class="subst">&#123;path2&#125;</span>&#x27;</span>)  <span class="comment"># 获取当前运行脚本的目录绝对路径（去掉最后一个路径）</span></span><br><span class="line"></span><br><span class="line">path3 = os.path.dirname(os.path.dirname(os.path.dirname(__file__)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path3: <span class="subst">&#123;path3&#125;</span>&#x27;</span>)  <span class="comment"># 获取当前运行脚本的目录绝对路径（去掉最后2个路径）</span></span><br><span class="line"></span><br><span class="line">path4 = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(__file__))))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path4: <span class="subst">&#123;path4&#125;</span>&#x27;</span>)  <span class="comment"># 获取当前运行脚本的目录绝对路径（去掉最后3个路径）</span></span><br><span class="line"></span><br><span class="line">path5 = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(__file__)))))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path5: <span class="subst">&#123;path5&#125;</span>&#x27;</span>)  <span class="comment"># 获取当前运行脚本的绝对路径（去掉最后4个路径）</span></span><br><span class="line"></span><br><span class="line">path6 = os.__file__  <span class="comment"># 获取os所在的目录</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;path6: <span class="subst">&#123;path6&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ⬇️ RUN RESULT ⬇️</span></span><br><span class="line"><span class="comment"># path0: /Users/junmingguo/Documents/mytest/A.py</span></span><br><span class="line"><span class="comment"># path1: /Users/junmingguo/Documents/mytest</span></span><br><span class="line"><span class="comment"># path2: /Users/junmingguo/Documents</span></span><br><span class="line"><span class="comment"># path3: /Users/junmingguo</span></span><br><span class="line"><span class="comment"># path4: /Users</span></span><br><span class="line"><span class="comment"># path5: /</span></span><br><span class="line"><span class="comment"># path6: /Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/os.py</span></span><br></pre></td></tr></table></figure>

<h2 id="合并字典"><a href="#合并字典" class="headerlink" title="合并字典"></a>合并字典</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x &#x3D; &#123;&#39;a&#39;: 1, &#39;b&#39;: 2&#125;</span><br><span class="line">y &#x3D; &#123;&#39;b&#39;: 3, &#39;c&#39;: 4&#125;</span><br><span class="line"></span><br><span class="line">z &#x3D; &#123;**x, **y&#125;  # &#123;&#39;a&#39;: 1, &#39;b&#39;: 3, &#39;c&#39;: 4&#125;</span><br><span class="line">或者</span><br><span class="line">z &#x3D; x.copy()</span><br><span class="line">z.update(y)</span><br></pre></td></tr></table></figure>

<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="built_in">print</span>(os.environ.get(<span class="string">&quot;ENDPOINT&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入（本地环境配置，实际使用时请自行导入环境变量）</span></span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line">load_dotenv()</span><br></pre></td></tr></table></figure>

<h2 id="输出当前类及方法"><a href="#输出当前类及方法" class="headerlink" title="输出当前类及方法"></a>输出当前类及方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">location = <span class="string">f&#x27;<span class="subst">&#123;self.__class__.__name__&#125;</span>/<span class="subst">&#123;sys._getframe().f_code.co_name&#125;</span>&#x27;</span></span><br><span class="line"><span class="comment"># 当前运行的 类 及 方法</span></span><br></pre></td></tr></table></figure>

<h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loop</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        loop()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    t1 = MyThread().start()</span><br><span class="line">    t2 = MyThread().start()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;执行完毕&quot;</span>)</span><br><span class="line"><span class="comment"># ⬇️ RUN RESULT ⬇️</span></span><br><span class="line"><span class="comment"># 执行完毕</span></span><br><span class="line"><span class="comment"># 00</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 4</span></span><br><span class="line"><span class="comment"># 4</span></span><br></pre></td></tr></table></figure>

<h2 id="Testcase"><a href="#Testcase" class="headerlink" title="Testcase"></a>Testcase</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">net_area: 指定网络区域</span><br><span class="line">pre_test():初始化</span><br><span class="line">run_test():测试用例</span><br><span class="line">post_run():释放资源</span><br><span class="line">使用debug_run(): 调用运行</span><br><span class="line">公共部分代码放到lib包</span><br><span class="line"></span><br><span class="line"># TestCase的SetUp和setUpTestData 区别</span><br><span class="line">you should use setUpTestData for the shared data and setUp for the per-test-method client</span><br><span class="line"></span><br><span class="line">setUp是每一个测试方法前都要运行，而setUpTestData是在数据初始化时运行</span><br></pre></td></tr></table></figure>

<h2 id="定时任务-schedule"><a href="#定时任务-schedule" class="headerlink" title="定时任务_schedule"></a>定时任务_schedule</h2><p>python任务定时运行库 schedule 模块 <a target="_blank" rel="noopener" href="https://schedule.readthedocs.io/en/stable/">schedule</a></p>
<p>（1）例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> schedule</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I&#x27;m working...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job1</span>(<span class="params">name</span>):</span>        <span class="comment">#带参数</span></span><br><span class="line">    <span class="built_in">print</span>(name)</span><br><span class="line"></span><br><span class="line">schedule.every(<span class="number">10</span>).minutes.do(job)              <span class="comment">#每10分钟执行一次</span></span><br><span class="line">schedule.every().hour.do(job)                   <span class="comment">#每小时执行一次  </span></span><br><span class="line">schedule.every().day.at(<span class="string">&quot;10:30&quot;</span>).do(job)        <span class="comment">#每天10:30执行一次  </span></span><br><span class="line">schedule.every().monday.do(job)                 <span class="comment">#每周星期一执行一次</span></span><br><span class="line">schedule.every().wednesday.at(<span class="string">&quot;13:15&quot;</span>).do(job)  <span class="comment">#每周星期三执行一次</span></span><br><span class="line">schedule.every().wednesday.at(<span class="string">&quot;13:15&quot;</span>).do(job1,<span class="string">&#x27;waiwen&#x27;</span>)  <span class="comment">#传入参数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    schedule.run_pending()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>（2）并行执行：为每一任务创建一个线程，使得任务并行工作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> schedule</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I&#x27;m running on thread %s&quot;</span> % threading.current_thread())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_threaded</span>(<span class="params">job_func</span>):</span></span><br><span class="line">    job_thread = threading.Thread(target=job_func)</span><br><span class="line">    job_thread.start()</span><br><span class="line"></span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(run_threaded, job)</span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(run_threaded, job)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    schedule.run_pending()</span><br></pre></td></tr></table></figure>

<p>（3）使用队列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> schedule</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I&#x27;m working&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">worker_main</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        job_func = jobqueue.get()</span><br><span class="line">        job_func()</span><br><span class="line">        jobqueue.task_done()</span><br><span class="line"></span><br><span class="line">jobqueue = Queue.Queue()</span><br><span class="line"></span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(jobqueue.put, job)</span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(jobqueue.put, job)</span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(jobqueue.put, job)</span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(jobqueue.put, job)</span><br><span class="line">schedule.every(<span class="number">10</span>).seconds.do(jobqueue.put, job)</span><br><span class="line"></span><br><span class="line">worker_thread = threading.Thread(target=worker_main)</span><br><span class="line">worker_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    schedule.run_pending()</span><br></pre></td></tr></table></figure>

<p>（4）仅执行一次</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">job_that_executes_once</span>():</span></span><br><span class="line">    <span class="comment"># Do some work ...</span></span><br><span class="line">    <span class="keyword">return</span> schedule.CancelJob</span><br><span class="line"></span><br><span class="line">schedule.every().day.at(<span class="string">&#x27;22:30&#x27;</span>).do(job_that_executes_once)</span><br></pre></td></tr></table></figure>

<p>（5）取消任务</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greet</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Hello &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(name))</span><br><span class="line"></span><br><span class="line">schedule.every().day.do(greet, <span class="string">&#x27;Andrea&#x27;</span>).tag(<span class="string">&#x27;daily-tasks&#x27;</span>, <span class="string">&#x27;friend&#x27;</span>)</span><br><span class="line">schedule.every().hour.do(greet, <span class="string">&#x27;John&#x27;</span>).tag(<span class="string">&#x27;hourly-tasks&#x27;</span>, <span class="string">&#x27;friend&#x27;</span>)</span><br><span class="line">schedule.every().hour.do(greet, <span class="string">&#x27;Monica&#x27;</span>).tag(<span class="string">&#x27;hourly-tasks&#x27;</span>, <span class="string">&#x27;customer&#x27;</span>)</span><br><span class="line">schedule.every().day.do(greet, <span class="string">&#x27;Derek&#x27;</span>).tag(<span class="string">&#x27;daily-tasks&#x27;</span>, <span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line"></span><br><span class="line">schedule.clear(<span class="string">&#x27;daily-tasks&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    schedule.run_pending()</span><br></pre></td></tr></table></figure>

<p>补充  - Ubuntu - crontab</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* * * * * source ～/.virtualenvrc &amp;&amp; workon cd_sdk &amp;&amp; python cipipeline.py #一分钟执行一次</span><br><span class="line">*/2 * * * * #两分钟执行一次</span><br></pre></td></tr></table></figure>

<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul>
<li>类方法 @classmethod</li>
</ul>
<p>描述：classmethod修饰符对应的函数不需要实例化，不需要 self 参数，但第一个参数需要是表示自身类的 cls 参数，可以来调用类的属性，类的方法，实例化对象等。</p>
<blockquote>
<p>@classmethod要与cls配合使用</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    bar = <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;foo&#x27;</span>) </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;func2&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span> (cls.bar)</span><br><span class="line">        cls().func1()   <span class="comment"># 调用 foo 方法</span></span><br><span class="line"> </span><br><span class="line">A.func2()               <span class="comment"># 不需要实例化</span></span><br></pre></td></tr></table></figure>

<ul>
<li>静态方法 @staticmethod</li>
</ul>
<p>描述：当不需要引用类或者实例时，建议将方法定义为静态方法。</p>
<ul>
<li>实例方法</li>
</ul>
<p>描述：实例方法只能被实例对象调用</p>
<blockquote>
<p>实例方法要与self配合使用</p>
</blockquote>
<h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timer</span>(<span class="params">func</span>):</span></span><br><span class="line"> <span class="string">&#x27;&#x27;&#x27;统计函数运行时间的装饰器&#x27;&#x27;&#x27;</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>():</span></span><br><span class="line">  start = time.time()</span><br><span class="line">  func()  <span class="comment"># 被装饰的函数</span></span><br><span class="line">  end = time.time()</span><br><span class="line">  used = end - start</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;func.__name__&#125;</span> used <span class="subst">&#123;used&#125;</span>&#x27;</span>)</span><br><span class="line"> <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step1</span>():</span></span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&#x27;step1.......&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step2</span>():</span></span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&#x27;step2......&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step3</span>():</span></span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&#x27;step3......&#x27;</span>)</span><br><span class="line"></span><br><span class="line">timed_step1 = timer(step1)</span><br><span class="line">timed_step2 = timer(step2)</span><br><span class="line">timed_step3 = timer(step3)</span><br><span class="line">timed_step1()</span><br><span class="line">timed_step2()</span><br><span class="line">timed_step3()</span><br></pre></td></tr></table></figure>

<p>语法糖</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step1</span>():</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;step1.......&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step2</span>():</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;step2......&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step3</span>():</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;step3......&#x27;</span>)</span><br><span class="line"></span><br><span class="line">step1()</span><br><span class="line">step2()</span><br><span class="line">step3()</span><br></pre></td></tr></table></figure>

<p>带参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step1</span>(<span class="params">num</span>):</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">f&#x27;我走了#<span class="subst">&#123;num&#125;</span>步&#x27;</span>)</span><br><span class="line"></span><br><span class="line">step1(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 会报错，因为python先调用wrapper函数，不接受参数而报错，在wrapper加参数</span></span><br><span class="line"><span class="comment"># --------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timer</span>(<span class="params">func</span>):</span></span><br><span class="line"> <span class="string">&#x27;&#x27;&#x27;统计函数运行时间的装饰器&#x27;&#x27;&#x27;</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">  start = time.time()</span><br><span class="line">  func(*args, **kwargs)  <span class="comment"># 被装饰的函数</span></span><br><span class="line">  end = time.time()</span><br><span class="line">  used = end - start</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;func.__name__&#125;</span> used <span class="subst">&#123;used&#125;</span>&#x27;</span>)</span><br><span class="line"> <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>

<p>被装饰的函数有返回值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timer</span>(<span class="params">func</span>):</span></span><br><span class="line"> <span class="string">&#x27;&#x27;&#x27;统计函数运行时间的装饰器&#x27;&#x27;&#x27;</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">  start = time.time()</span><br><span class="line">  ret_value = func(*args, **kwargs)  <span class="comment"># 获取被装饰的函数返回值</span></span><br><span class="line">  end = time.time()</span><br><span class="line">  used = end - start</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;func.__name__&#125;</span> used <span class="subst">&#123;used&#125;</span>&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> ret_value  <span class="comment"># return 返回值 </span></span><br><span class="line"> <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">num1, num2</span>):</span></span><br><span class="line"> <span class="keyword">return</span> num1 + num2</span><br><span class="line"></span><br><span class="line"><span class="built_in">sum</span> = add(<span class="number">5</span>, <span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>

<h2 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h2><p>浅拷贝：仅复制被拷贝对象原先的数据，并指向相同的存储位置（共用一部分数据存储位置）</p>
<p>![image-20210107191323129](/Users/junmingguo/Library/Application Support/typora-user-images/image-20210107191323129.png)</p>
<p>被拷贝的数据中存在可变数据，浅拷贝的对象与被拷贝对象保持一致</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/fhujzoQe7TrGa4hyhWRYBIYJImp81lDuaYQNIb7icoqbV5qzqRrAIMGibNeWicsSBib8Lp5Sd7JCEiap1QMcKz8f07A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>若修改不可变数据（例如int类型），则浅拷贝的对象不更新</p>
<p>![image-20210107191613395](/Users/junmingguo/Library/Application Support/typora-user-images/image-20210107191613395.png)</p>
<p>深拷贝：复制一个完全独立的对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import copy</span><br><span class="line">l1 &#x3D; [1, 2, 3, [22, 33]]</span><br><span class="line">l2 &#x3D; copy.deepcopy(l1)</span><br><span class="line">l1.append(666)</span><br></pre></td></tr></table></figure>

<p>![image-20210107191722877](/Users/junmingguo/Library/Application Support/typora-user-images/image-20210107191722877.png)</p>
<h2 id="deepcopy-使用示例"><a href="#deepcopy-使用示例" class="headerlink" title="deepcopy 使用示例"></a>deepcopy 使用示例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># list/dict: 直接赋值会影响原先 list/dict</span></span><br><span class="line">a = &#123;<span class="number">1</span>:<span class="number">1</span>, <span class="number">2</span>:<span class="number">2</span>&#125;</span><br><span class="line">b = a</span><br><span class="line">b[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># &#123;1:1, 2:2, 3:3&#125;</span></span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># &#123;1:1, 2:2, 3:3&#125;</span></span><br><span class="line"><span class="comment"># 需要使用deepcopy</span></span><br></pre></td></tr></table></figure>

<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Json-loads-和-dumps"><a href="#Json-loads-和-dumps" class="headerlink" title="Json loads 和 dumps"></a>Json loads 和 dumps</h2><p>1⃣️ String-&gt;<code>json.loads()</code>-&gt; Json Object</p>
<p>2⃣️ Json Object -&gt;<code>json.dumps()</code>-&gt;String</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">json.loads(&#39;13&#39;)---&gt;13</span><br><span class="line">json.loads(&#39;1.0.1&#39;)---&gt;JsonDecodeError</span><br></pre></td></tr></table></figure>

<h2 id="-1"><a href="#-1" class="headerlink" title="_"></a>_</h2><ol>
<li><p>以单个下划线开头的变量或方法仅供内部使用，其中针对变量只是约定而已，而对于方法而言，在使用from abc import *时将无法导入单下划线开头的方法，常规导入import abc，可以正常导入。</p>
</li>
<li><p>以单个下划线结尾的变量或者方法，像class或def这样的名称不能用作Python中的变量名称</p>
</li>
<li><p>以双个下划线开头的变量，例如class的变量，使用dir时将无法直接获取对应的变量名，而是_类名__变量，称为名称修饰，防止变量在子类中被重写，双下划线名称修饰对程序员是完全透明的。</p>
</li>
<li><p>双前导和双末尾下划线的名称，用于特殊用途。这样的例子有，<code>__init__</code>对象构造函数，或<code>__call__</code> — 它使得一个对象可以被调用。</p>
</li>
</ol>
<h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> cls._instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            cls._instance = <span class="built_in">object</span>.__new__(cls, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> cls._instance</span><br><span class="line">      </span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_client_exception</span>(<span class="params">OperationException</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    处理客户端异常</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorate</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = func(*args, **kwargs)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hasattr</span>(response, <span class="string">&#x27;code&#x27;</span>) <span class="keyword">and</span> response.code:</span><br><span class="line">                    <span class="keyword">raise</span> OperationException(</span><br><span class="line">                        error_code=response.code,</span><br><span class="line">                        func_name=func.__name__,</span><br><span class="line">                        message=response.message</span><br><span class="line">                    )</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:  <span class="comment"># pylint: disable=broad-except</span></span><br><span class="line">                <span class="keyword">raise</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorate</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<h2 id="init-amp-new"><a href="#init-amp-new" class="headerlink" title="init &amp; new"></a>init &amp; new</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 知识点: __init__，创建方法后默认调用，不需要返回值（不允许返回非None值）</span></span><br><span class="line"><span class="comment"># __new__必须包含参数cls，表示当前类，且必须要有返回值，可以return 父类</span></span><br><span class="line"><span class="comment"># 先执行__new__后自动调用__init__</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span>  <span class="comment"># -&gt; don&#x27;t forget the object specified as base</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;A.__new__ called&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>(A, cls).__new__(cls)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;A.__init__ called&quot;</span>)</span><br><span class="line"></span><br><span class="line">A()</span><br></pre></td></tr></table></figure>



<h2 id="property"><a href="#property" class="headerlink" title="property"></a>property</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._age = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age_getter</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age_setter</span>(<span class="params">self, age</span>):</span></span><br><span class="line">        self._age = age</span><br><span class="line"></span><br><span class="line">    age = <span class="built_in">property</span>(age_getter, age_setter)  <span class="comment"># property是一种特殊的赋值__init__的方法</span></span><br><span class="line"></span><br><span class="line">s=Student()</span><br><span class="line"><span class="built_in">print</span>(s.age_setter(<span class="number">11</span>))</span><br><span class="line"><span class="built_in">print</span>(s.age_getter())</span><br><span class="line"></span><br><span class="line">s.age = <span class="number">22</span></span><br><span class="line"><span class="built_in">print</span>(s.age)</span><br><span class="line"><span class="built_in">print</span>(s._age)</span><br></pre></td></tr></table></figure>

<h2 id="装饰器来实现getter、setter、和deleter"><a href="#装饰器来实现getter、setter、和deleter" class="headerlink" title="装饰器来实现getter、setter、和deleter"></a>装饰器来实现getter、setter、和deleter</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._age = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self, age</span>):</span></span><br><span class="line">        self._age = age</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @age.deleter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">del</span> self._age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">student = Student()</span><br><span class="line">student.age = <span class="number">20</span></span><br><span class="line"><span class="built_in">print</span> (student.age)</span><br><span class="line"><span class="keyword">del</span> student.age</span><br></pre></td></tr></table></figure>

<h2 id="消除警告"><a href="#消除警告" class="headerlink" title="消除警告"></a>消除警告</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="os"><a href="#os" class="headerlink" title="os"></a>os</h2><p>os.remove()报错：限权不够</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line">shutil.rmtree(file_name)</span><br></pre></td></tr></table></figure>

<p>获取当前工作目录，即当前Python脚本工作的目录路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.getcwd()</span><br></pre></td></tr></table></figure>

<p>获取指定工作目录的文件名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.listdir()</span><br></pre></td></tr></table></figure>

<p>删除指定文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.remove()</span><br></pre></td></tr></table></figure>

<p>删除多个目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.removedirs(r<span class="string">&quot;c：\python&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="小数点相加误差"><a href="#小数点相加误差" class="headerlink" title="小数点相加误差"></a>小数点相加误差</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from decimal import getcontext,Decimal</span><br><span class="line"><span class="comment"># 精确到小数点后几位</span></span><br><span class="line">getcontext().prec = 2</span><br><span class="line"><span class="built_in">print</span>(Decimal(0.1)+Decimal(0.2))</span><br></pre></td></tr></table></figure>

<h2 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h2><p>保存csv文件时中文乱码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.to_csv(<span class="string">&#x27;basic.csv&#x27;</span>,encoding=<span class="string">&quot;utf_8_sig&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>读取csv文件的中文编码格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"><span class="comment"># 读取csv文件(Dataframe格式)</span></span><br><span class="line">fund_return = pd.read_csv(<span class="string">&#x27;train_fund_return.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># 涉及到中文读取编码错误</span></span><br><span class="line">index_return = pd.read_csv(<span class="string">&#x27;train_index_return.csv&#x27;</span>,encoding=<span class="string">&#x27;gb18030&#x27;</span>)</span><br><span class="line"><span class="comment"># 或者gb2312</span></span><br><span class="line"><span class="built_in">print</span>(index_return)</span><br></pre></td></tr></table></figure>

<p>储存为csv文件时不添加index</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import tushare as ts</span><br><span class="line">stock_data = ts.get_k_data(<span class="string">&#x27;002253&#x27;</span>)</span><br><span class="line"><span class="comment"># 删除指定列</span></span><br><span class="line">del stock_data[<span class="string">&#x27;code&#x27;</span>]</span><br><span class="line"><span class="comment"># 存入csv时不添加index</span></span><br><span class="line">stock_data.to_csv(<span class="string">&#x27;002253.csv&#x27;</span>,index=None)</span><br><span class="line"><span class="comment"># 或者index=False</span></span><br></pre></td></tr></table></figure>

<h2 id="单行实现嵌套for循环"><a href="#单行实现嵌套for循环" class="headerlink" title="单行实现嵌套for循环"></a>单行实现嵌套for循环</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list1 = <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">list2 = <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line">list3 = <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">9</span>)</span><br><span class="line"><span class="keyword">for</span> item1 <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">for</span> item2 <span class="keyword">in</span> list2:</span><br><span class="line">       <span class="keyword">for</span> item3 <span class="keyword">in</span> list3:</span><br><span class="line">           <span class="built_in">print</span>(item1+item2+item3)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">list1 = <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">list2 = <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line">list3 = <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">9</span>)</span><br><span class="line"><span class="keyword">for</span> item1,item2,item3 <span class="keyword">in</span> product(list1, list2, list3):</span><br><span class="line">    <span class="built_in">print</span>(item1+item2+item3)</span><br></pre></td></tr></table></figure>

<h2 id="计算函数运行时间"><a href="#计算函数运行时间" class="headerlink" title="计算函数运行时间"></a>计算函数运行时间</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">start = time.time()</span><br><span class="line"></span><br><span class="line"><span class="comment"># run the function</span></span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(end-start)</span><br></pre></td></tr></table></figure>

<p>更简单的计算方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_sleep</span>(<span class="params">second</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(second)</span><br><span class="line">    time.sleep(second)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只用这一行</span></span><br><span class="line"><span class="built_in">print</span>(timeit.timeit(<span class="keyword">lambda</span> :run_sleep(<span class="number">2</span>), number=<span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<h2 id="列表解包"><a href="#列表解包" class="headerlink" title="列表解包"></a>列表解包</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array = [[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>], [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], [<span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>]]</span><br><span class="line">transposed = <span class="built_in">zip</span>(*array)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(transposed))</span><br></pre></td></tr></table></figure>

<h2 id="合并字典-1"><a href="#合并字典-1" class="headerlink" title="合并字典"></a>合并字典</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dicta,dictb</span><br><span class="line">dictc = dicta.copy()</span><br><span class="line">dictc.update(dictb)</span><br><span class="line">或者</span><br><span class="line">&#123;**dicta, **dictb&#125;</span><br></pre></td></tr></table></figure>

<h2 id="运行过程输出源代码"><a href="#运行过程输出源代码" class="headerlink" title="运行过程输出源代码"></a>运行过程输出源代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=====source code=====&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(inspect.getsource(add))</span><br></pre></td></tr></table></figure>

<h2 id="时间戳"><a href="#时间戳" class="headerlink" title="时间戳"></a>时间戳</h2><p>时间格式→时间戳</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">dt = <span class="string">&quot;2016-05-05 20:28:54&quot;</span></span><br><span class="line"><span class="comment">#转换成时间数组</span></span><br><span class="line">timeArray = time.strptime(dt, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"><span class="comment">#转换成时间戳</span></span><br><span class="line">timestamp = time.mktime(timeArray)</span><br><span class="line"><span class="built_in">print</span> (timestamp)</span><br></pre></td></tr></table></figure>

<p>时间戳→时间格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">timestamp = 1462451334</span><br><span class="line"><span class="comment"># 转换成localtime</span></span><br><span class="line">time_local = time.localtime(timestamp)</span><br><span class="line"><span class="comment"># 转换成新的时间格式(2016-05-05 20:28:54)</span></span><br><span class="line">dt = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,time_local)</span><br><span class="line"><span class="built_in">print</span> (dt)</span><br></pre></td></tr></table></figure>

<h2 id="字符串转换"><a href="#字符串转换" class="headerlink" title="字符串转换"></a>字符串转换</h2><ul>
<li><p>b’input\n’ # bytes字节符，打印以b开头</p>
</li>
<li><p>r’input\n’ # 非转义原生字符，经处理’\n’变成了’\‘和’n’。也就是\n表示的是两个字符，而不是换行</p>
</li>
<li><p>u’input\n’ # unicode编码字符，python3默认字符串编码方式。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bytyes -&gt; str </span></span><br><span class="line">a = <span class="string">b&#x27;sql\xe6\x89\xa7\xe8\xa1\x8c\xe5\xa4\xb1\xe8\xb4\xa5&#x27;</span></span><br><span class="line">c = a.decode(<span class="string">&quot;utf-8&quot;</span>) <span class="comment"># 中文</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bytyes -&gt; str</span></span><br><span class="line">a = <span class="string">u&#x27;\u5f55\u5165\u4ee3\u7801\u5e93&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># 中文</span></span><br></pre></td></tr></table></figure>

<h2 id="pip下载源优先顺序调整"><a href="#pip下载源优先顺序调整" class="headerlink" title="pip下载源优先顺序调整"></a>pip下载源优先顺序调整</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find ~ -name &#39;pip.con&#39;</span><br><span class="line">vi &#x2F;Users&#x2F;junmingguo&#x2F;.pip&#x2F;pip.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url &#x3D; http:&#x2F;&#x2F;mirrors.example.com&#x2F;repository&#x2F;simple&#x2F;</span><br><span class="line">extra-index-url &#x3D; http:&#x2F;&#x2F;pypi.example.com&#x2F;simple&#x2F;</span><br><span class="line">                  https:&#x2F;&#x2F;mirrors.example.com&#x2F;pypi&#x2F;simple&#x2F;</span><br><span class="line"></span><br><span class="line">trusted-host &#x3D; mirrors.abc.example.com</span><br><span class="line">               mirrors.example.com</span><br><span class="line">               pypi.example.com</span><br><span class="line">no-cache-dir &#x3D; true</span><br><span class="line">disable-pip-version-check &#x3D; true</span><br></pre></td></tr></table></figure>

<p>其中<code>index-url</code>为第一下载源，<code>extra-index-url</code>为备用下载源</p>
<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><p>定义：通过字符串映射object对象的方法或者属性</p>
<p>方法：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hasattr(obj,name_str): 判断objec是否有name_str这个方法或者属性</span><br><span class="line">getattr(obj,name_str): 获取<span class="built_in">object</span>对象中与name_str同名的方法或者函数</span><br><span class="line">setattr(obj,name_str,<span class="keyword">value</span>): 为<span class="built_in">object</span>对象设置一个以name_str为名的<span class="keyword">value</span>方法或者属性</span><br><span class="line">delattr(obj,name_str): 删除<span class="built_in">object</span>对象中的name_str方法或者属性</span><br></pre></td></tr></table></figure>

<h2 id="arg-kwargs"><a href="#arg-kwargs" class="headerlink" title="*arg **kwargs"></a>*arg **kwargs</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">demo</span>(<span class="params">a, *args, **kwargs</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line">    <span class="built_in">print</span>(kwargs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">demo(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"></span><br><span class="line">demo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># (2, 3)</span></span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"></span><br><span class="line">demo(a=<span class="number">1</span>, name=<span class="string">&#x27;jm&#x27;</span>)</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># None</span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;jm&#x27;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="python2-amp-3-下的range"><a href="#python2-amp-3-下的range" class="headerlink" title="python2 &amp; 3 下的range()"></a>python2 &amp; 3 下的range()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2 返回列表</span></span><br><span class="line"><span class="built_in">range</span>(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># [0,1]</span></span><br><span class="line"><span class="comment"># python3 返回迭代器（节约内存）</span></span><br><span class="line"><span class="built_in">range</span>(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># range(0,2)</span></span><br></pre></td></tr></table></figure>

<h2 id="避免转义字符"><a href="#避免转义字符" class="headerlink" title="避免转义字符"></a>避免转义字符</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">r&#x27;abc\ndef&#x27;</span>  <span class="comment"># abc\ndef</span></span><br><span class="line"><span class="string">&#x27;abc\ndef&#x27;</span>	 <span class="comment"># abc</span></span><br><span class="line">						 <span class="comment"># def</span></span><br></pre></td></tr></table></figure>

<h2 id="根据字典键值进行排序"><a href="#根据字典键值进行排序" class="headerlink" title="根据字典键值进行排序"></a>根据字典键值进行排序</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=&#123;<span class="number">1</span>:<span class="number">2</span>, <span class="number">2</span>:<span class="number">1</span>, <span class="number">3</span>:<span class="number">3</span>, <span class="number">4</span>:<span class="number">0</span>&#125;</span><br><span class="line">b=<span class="built_in">dict</span>(<span class="built_in">sorted</span>(a.items(), key=<span class="keyword">lambda</span> item: item[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h2 id="str-isalpha"><a href="#str-isalpha" class="headerlink" title="str.isalpha"></a>str.isalpha</h2><p>python2 下对’中文’进行isalpha则返回False</p>
<p>python3 下对’中文’ 进行isalpha则返回True，要实现与python2一致的逻辑则需要进行转义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line">a = <span class="string">&quot;runoob&quot;</span></span><br><span class="line"><span class="built_in">print</span> a.isalpha()</span><br><span class="line"></span><br><span class="line">b = <span class="string">&quot;runoob菜鸟教程&quot;</span></span><br><span class="line"><span class="built_in">print</span> b.isalpha()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line">a = <span class="string">&quot;runoob&quot;</span></span><br><span class="line"><span class="built_in">print</span>(a.encode(<span class="string">&#x27;UTF-8&#x27;</span>).isalpha())</span><br></pre></td></tr></table></figure>

<h2 id="amp-区别"><a href="#amp-区别" class="headerlink" title="(.*?) &amp; (.*)区别"></a>(.*?) &amp; (.*)区别</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (.*) 是贪婪匹配：满足正则的尽可能地多匹配</span></span><br><span class="line"><span class="comment"># (.*?) 是非贪婪匹配：满足正则的尽可能地少匹配</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s=<span class="string">&quot;&lt;a&gt;哈哈&lt;/a&gt;&lt;a&gt;嘿嘿&lt;/a&gt;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&quot;&lt;a&gt;(.*)&lt;/a&gt;&quot;</span>,s))</span><br><span class="line"><span class="comment"># [&#x27;哈哈&lt;/a&gt;&lt;a&gt;嘿嘿&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&quot;&lt;a&gt;(.*?)&lt;/a&gt;&quot;</span>,s))</span><br><span class="line"><span class="comment"># [&#x27;哈哈&#x27;, &#x27;嘿嘿&#x27;]</span></span><br></pre></td></tr></table></figure>

<h2 id="int-强制转换"><a href="#int-强制转换" class="headerlink" title="int()强制转换"></a>int()强制转换</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换成int类型的示例</span></span><br><span class="line"><span class="built_in">int</span>(<span class="number">1.2</span>)</span><br><span class="line"><span class="built_in">int</span>(-<span class="number">1.2</span>)</span><br><span class="line"><span class="built_in">int</span>(+<span class="number">1.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="built_in">int</span>(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line"><span class="built_in">int</span>(<span class="string">&quot;1.2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法参数及注释</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x, base=<span class="number">10</span></span>):</span>  <span class="comment"># known special case of int.__init__</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    int([x]) -&gt; integer</span></span><br><span class="line"><span class="string">    int(x, base=10) -&gt; integer</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Convert a number or string to an integer, or return 0 if no arguments</span></span><br><span class="line"><span class="string">    are given.  If x is a number, return x.__int__().  For floating point</span></span><br><span class="line"><span class="string">    numbers, this truncates towards zero.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    If x is not a number or if base is given, then x must be a string,</span></span><br><span class="line"><span class="string">    bytes, or bytearray instance representing an integer literal in the</span></span><br><span class="line"><span class="string">    given base.  The literal can be preceded by &#x27;+&#x27; or &#x27;-&#x27; and be surrounded</span></span><br><span class="line"><span class="string">    by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.</span></span><br><span class="line"><span class="string">    Base 0 means to interpret the base from the string as an integer literal.</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; int(&#x27;0b100&#x27;, base=0)</span></span><br><span class="line"><span class="string">    4</span></span><br><span class="line"><span class="string">    # (copied from class doc)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># 理解</span></span><br><span class="line"><span class="built_in">int</span>(x, base=<span class="number">10</span>)</span><br><span class="line"><span class="number">1.</span> 若x非数字则必须为字符串或者字节、字节数组实例</span><br><span class="line"><span class="number">2.</span> base表示进制，默认为<span class="number">10</span>，有效范围是[<span class="number">0</span>,<span class="number">2</span>-<span class="number">36</span>]，<span class="number">0</span>表示将字符串转换为整型，无论base值为多少，转换后的数值为十进制整数。</span><br></pre></td></tr></table></figure>

<h2 id="不支持double字段"><a href="#不支持double字段" class="headerlink" title="不支持double字段"></a>不支持double字段</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">double(<span class="number">0.8</span>)  <span class="comment"># 报错</span></span><br></pre></td></tr></table></figure>

<h2 id="index-数组索引不存在"><a href="#index-数组索引不存在" class="headerlink" title="[index:]数组索引不存在"></a>[index:]数组索引不存在</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b = a[<span class="number">10</span>:]  <span class="comment"># 输出 b = [],在获取列表切片时若begin index超过成员变量不会触发indexerror</span></span><br></pre></td></tr></table></figure>

<h2 id="complex"><a href="#complex" class="headerlink" title="complex"></a>complex</h2><p>complex是复数类型，由实部和虚部组成，即<code>real</code>+<code>imag</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">complex</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># (1+2j)</span></span><br><span class="line"><span class="built_in">complex</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># (1+0j)</span></span><br><span class="line"><span class="built_in">complex</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="comment"># (1)</span></span><br></pre></td></tr></table></figure>

<h2 id="groupby-amp-itemgetter"><a href="#groupby-amp-itemgetter" class="headerlink" title="groupby &amp; itemgetter"></a>groupby &amp; itemgetter</h2><p>分组函数 <code>groupby</code></p>
<p><code>itemgetter</code>获取字典<code>key</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> groupby</span><br><span class="line">d1=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;zhangsan&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">20</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>&#125;</span><br><span class="line">d2=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;wangwu&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">19</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;USA&#x27;</span>&#125;</span><br><span class="line">d3=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lisi&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">22</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;JP&#x27;</span>&#125;</span><br><span class="line">d4=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;zhaoliu&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">22</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;USA&#x27;</span>&#125;</span><br><span class="line">d5=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;pengqi&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">22</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;USA&#x27;</span>&#125;</span><br><span class="line">d6=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lijiu&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">22</span>,<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>&#125;</span><br><span class="line">lst=[d1,d2,d3,d4,d5,d6]</span><br><span class="line"><span class="comment"># [&#123;&#x27;name&#x27;: &#x27;zhangsan&#x27;, &#x27;age&#x27;: 20, &#x27;country&#x27;: &#x27;China&#x27;&#125;,</span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;wangwu&#x27;, &#x27;age&#x27;: 19, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;lisi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;JP&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;zhaoliu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;pengqi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;lijiu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;China&#x27;&#125;]</span></span><br><span class="line"></span><br><span class="line">lst.sort(key=itemgetter(<span class="string">&#x27;age&#x27;</span>)) <span class="comment">#需要先排序，然后才能groupby。lst排序后自身被改变</span></span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="comment"># [&#123;&#x27;name&#x27;: &#x27;wangwu&#x27;, &#x27;age&#x27;: 19, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;zhangsan&#x27;, &#x27;age&#x27;: 20, &#x27;country&#x27;: &#x27;China&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;lisi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;JP&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;zhaoliu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;pengqi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, </span></span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;lijiu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;China&#x27;&#125;]</span></span><br><span class="line"></span><br><span class="line">lstg = groupby(lst,itemgetter(<span class="string">&#x27;country&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key,group <span class="keyword">in</span> lstg:</span><br><span class="line">        <span class="built_in">print</span> (key,<span class="built_in">list</span>(g))  <span class="comment"># group是一个迭代器，包含了所有的分组列表</span></span><br><span class="line"><span class="comment"># 19 [&#123;&#x27;name&#x27;: &#x27;wangwu&#x27;, &#x27;age&#x27;: 19, &#x27;country&#x27;: &#x27;USA&#x27;&#125;]</span></span><br><span class="line"><span class="comment"># 20 [&#123;&#x27;name&#x27;: &#x27;zhangsan&#x27;, &#x27;age&#x27;: 20, &#x27;country&#x27;: &#x27;China&#x27;&#125;]</span></span><br><span class="line"><span class="comment"># 22 [&#123;&#x27;name&#x27;: &#x27;lisi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;JP&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;zhaoliu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;pengqi&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;USA&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;lijiu&#x27;, &#x27;age&#x27;: 22, &#x27;country&#x27;: &#x27;China&#x27;&#125;]</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/04/01/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/" data-id="ckmzn8px00018j2td8pv489sj" data-title="日常笔记——Python" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/04/01/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
    <a href="/2021/03/31/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Elasticsearch/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">日常笔记——Elasticsearch</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Notes/">Notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Others/">Others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Study/">Study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Testing/">Testing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cos/">cos</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/idea/">idea</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/06/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Sentry/">日常笔记——Sentry</a>
          </li>
        
          <li>
            <a href="/2021/04/02/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94urljoin/">日常笔记——urljoin</a>
          </li>
        
          <li>
            <a href="/2021/04/01/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94k8s/">日常笔记——k8s</a>
          </li>
        
          <li>
            <a href="/2021/04/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/04/01/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0%E2%80%94%E2%80%94Python/">日常笔记——Python</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Jimmy Guo<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>